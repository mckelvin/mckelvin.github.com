<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>国内豆瓣用户地理分布</title>
    <script type="text/javascript" src="js/lib/jquery.js"></script>
    <script type="text/javascript" src="js/lib/raphael-min.js"></script>
    <script type="text/javascript" src="js/res/chinaMapConfig.js"></script>
    <script type="text/javascript" src="js/map.js"></script>

    <style type="text/css">
      /* base */
      html{background:#fff;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}body,ul,ol,dl,dd,h1,h2,h3,h4,h5,h6,p,form,fieldset,legend,input,textarea,select,button,th,td,div{margin:0; padding:0}button,input,select,textarea{font:12px/1.5 tahoma,Helvetica,arial,\5b8b\4f53}input,select,textarea{font-size:100%}table{border-collapse:collapse;border-spacing:0}th{text-align:inherit}fieldset,img{border:0}iframe{display:block}ol,ul,li{list-style:none}del{text-decoration:line-through}ins,a{text-decoration:none}a:focus{outline:none}h1,h2,h3,h4,h5,h6{font-size:100%}.clear{clear:both}.clearfix:after{content:".";display:block;height:0;font-size:0;clear:both;visibility:hidden}.clearfix{zoom:1}
      /* base */

      body{font:12px/1.5 "Lucida Grande","Lucida Sans Unicode", Tahoma, SimSun,Helvetica,sans-serif; color:#2E313A;}
      .wrap{ width:900px; margin:0 auto; background:url(bg.png); border-left:1px solid #DDD; border-right:1px solid #DDD;}
      a{color:#0e4279; -moz-transition:color 0.3s ease 0s;}
      a:hover{color:#5B636A;}
      h1{ padding:20px 0 0 20px; font-size:24px; line-height:50px;} 
      h2{ margin-top:30px; padding-left:10px; background-color: #ddd; font-size:14px; line-height:30px;}


      /* 提示自定义 */
      .stateTip, #StateTip{display:none; position:absolute; padding:8px; background:#fff; border:2px solid #2385B1; -moz-border-radius: 4px; -webkit-border-radius: 4px; border-radius: 4px; font-size:12px; font-family:Tahoma; color:#333;}

      .mapInfo i{ display:inline-block; width:15px; height:15px; margin-top:5px; line-height:15px; font-style:normal; background:#aeaeae; color:#fff; font-size:11px; font-family: Tahoma; -webkit-border-radius:15px; border-radius:15px; text-align:center}
      .mapInfo i.active{background:#E27F21;}
      .mapInfo span{ padding:0 5px 0 3px;}
      .mapInfo b{ font-weight:normal; color:#2770B5}
    </style>

    <script type="text/javascript">
      $(function(){

        // $.ajax({
        // 	url: projectName+'/idea123Action.do?method=getIdea123MapData&reportName='+reportName,
        // 	data: data,
        // 	dataType: 'json',
        // 	success: function(data){

        var data = {'guangdong': {'stateInitColor': 0, 'value': 2343565},'beijing': {'stateInitColor': 0, 'value': 2299106},'shanghai': {'stateInitColor': 2, 'value': 1398375},'jiangsu': {'stateInitColor': 3, 'value': 1319702},'zhejiang': {'stateInitColor': 3, 'value': 1244506},'shandong': {'stateInitColor': 4, 'value': 887680},'sichuan': {'stateInitColor': 4, 'value': 860553},'hubei': {'stateInitColor': 4, 'value': 856491},'fujian': {'stateInitColor': 4, 'value': 705669},'henan': {'stateInitColor': 4, 'value': 704736},'liaoning': {'stateInitColor': 4, 'value': 609355},'hunan': {'stateInitColor': 5, 'value': 578517},'shaanxi': {'stateInitColor': 5, 'value': 570056},'hebei': {'stateInitColor': 5, 'value': 470385},'anhui': {'stateInitColor': 5, 'value': 410744},'chongqing': {'stateInitColor': 5, 'value': 371059},'heilongjiang': {'stateInitColor': 5, 'value': 367740},'tianjin': {'stateInitColor': 5, 'value': 359158},'guangxi': {'stateInitColor': 5, 'value': 308632},'jiangxi': {'stateInitColor': 5, 'value': 287907},'shanxi': {'stateInitColor': 5, 'value': 287374},'jilin': {'stateInitColor': 5, 'value': 279682},'yunnan': {'stateInitColor': 5, 'value': 247960},'neimongol': {'stateInitColor': 6, 'value': 161889},'guizhou': {'stateInitColor': 6, 'value': 141426},'gansu': {'stateInitColor': 6, 'value': 131083},'xinjiang': {'stateInitColor': 6, 'value': 120144},'hainan': {'stateInitColor': 6, 'value': 81129},'hongkong': {'stateInitColor': 6, 'value': 70057},'taiwan': {'stateInitColor': 6, 'value': 62220},'ningxia': {'stateInitColor': 6, 'value': 56560},'qinghai': {'stateInitColor': 6, 'value': 45367},'xizang': {'stateInitColor': 6, 'value': 32197},'macau': {'stateInitColor': 6, 'value': 9623},};
        var i = 1;
        for(k in data){
          if(i <= 12){
            var _cls = i < 4 ? 'active' : ''; 
            $('#MapControl .list1').append('<li name="'+k+'"><div class="mapInfo"><i class="'+_cls+'">'+(i++)+'</i><span>'+chinaMapConfig.names[k]+'</span><b>'+data[k].value+'</b></div></li>')
          }else if(i <= 24){
            $('#MapControl .list2').append('<li name="'+k+'"><div class="mapInfo"><i>'+(i++)+'</i><span>'+chinaMapConfig.names[k]+'</span><b>'+data[k].value+'</b></div></li>')
          }else{
            $('#MapControl .list3').append('<li name="'+k+'"><div class="mapInfo"><i>'+(i++)+'</i><span>'+chinaMapConfig.names[k]+'</span><b>'+data[k].value+'</b></div></li>')
          }
        }

        var mapObj_1 = {};

        $('#RegionMap').SVGMap({
          external: mapObj_1,
          mapName: 'china',
          mapWidth: 350,
          mapHeight: 350,
          stateData: data,
          // stateTipWidth: 118,
          // stateTipHeight: 47,
          // stateTipX: 2,
          // stateTipY: 0,
          stateTipHtml: function (mapData, obj) {
            var _value = mapData[obj.id].value;
            var _idx = mapData[obj.id].index;
            var active = '';
            _idx < 4 ? active = 'active' : active = '';
            var tipStr = '<div class="mapInfo"><i class="' + active + '">' + _idx + '</i><span>' + obj.name + '</span><b>' + _value + '</b></div>';
            return tipStr;
          }
        });
        $('#MapControl li').hover(function () {
          var thisName = $(this).attr('name');

          var thisHtml = $(this).html();
          $('#MapControl li').removeClass('select');
          $(this).addClass('select');
          $(document.body).append('<div id="StateTip"></div');
          $('#StateTip').css({
            left: $(mapObj_1[thisName].node).offset().left - 50,
            top: $(mapObj_1[thisName].node).offset().top - 40
          }).html(thisHtml).show();
          mapObj_1[thisName].attr({
            fill: '#E99A4D'
          });
        }, function () {
          var thisName = $(this).attr('name');

          $('#StateTip').remove();
          $('#MapControl li').removeClass('select');
          mapObj_1[$(this).attr('name')].attr({
            fill: "#" + stateColorList[data[$(this).attr('name')].stateInitColor]
          });
        });

        $('#MapColor').show();
        // 	}
        // });


      });
    </script>
  </head>
  <body>
    <div class="wrap">
      <h1>国内豆瓣用户地理分布</h1>
      <div class="items" id="Item9">
        <h2>省份、自治区、直辖市、地区</h2>
        <a href="javascript:;" class="fold"></a>
        <div class="itemCon">
          <style type="text/css">
            .regionList{float:left; margin-top:15px;}
            .regionList ul{float:left; width:110px; height:100%; margin-right:5px; display:inline; font-family:"微软雅黑"}
            .regionList ul li{ height:24px; margin-left:5px; padding:0 0px; border:1px solid #fff; line-height:24px;}
            .regionList ul li.select{border:1px solid #D3D3D3; background:#FFF1BF}

            .mapInfo i{ display:inline-block; width:15px; height:15px; margin-top:5px; line-height:15px; font-style:normal; background:#aeaeae; color:#fff; font-size:11px; font-family: Tahoma; -webkit-border-radius:15px; border-radius:15px; text-align:center}
            .mapInfo i.active{background:#E27F21;}
            .mapInfo span{ padding:0 5px 0 3px;}
            .mapInfo b{ font-weight:normal; color:#2770B5}

            .regionMap{float:left; margin-left:70px; display:inline;}
          </style>
          <div id="Region" style="position:relative; height:360px;">
            <div class="regionList" id="MapControl">
              <ul class="list1"></ul>
              <ul class="list2"></ul>
              <ul class="list3"></ul>
            </div>
            <div class="regionMap" id="RegionMap"></div>
            <div id="MapColor" style=" display:none; float:left; width:30px; height:180px; margin:80px 0 0 10px; display:inline; background:url(images/map_color.png) center 0;"></div>
          </div>
        </div>
      </div>
      <p>数据来源: <a href="http://www.douban.com/j/location/china/" target="_blank">http://www.douban.com/j/location/china/</a>
      <p>地图：<a href="https://github.com/rockyuse/svgmap" target="_blank">https://github.com/rockyuse/svgmap</a>
      <p> -- mckelvin
    </div>


    <link rel="stylesheet" type="text/css" href="css/SyntaxHighlighter.css">
    <script type="text/javascript" src="js/lib/SyntaxHighlighter.js"></script>
  </body>
</html>
